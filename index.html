<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>Paix√£oFlix WebTV</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logo512.png?raw=true">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>

<style>
body{margin:0;background:#000;color:#fff;font-family:Poppins;display:flex;height:100vh;overflow:hidden}
#side{width:320px;background:#111;display:flex;flex-direction:column}
#header{padding:20px}
#logo{max-width:150px}
#list{flex:1;overflow-y:auto}
.item{padding:14px;border-bottom:1px solid #222;cursor:pointer}
.item.focus{background:#222;border-left:5px solid #e50914}
#player{flex:1;background:#000}
video{width:100%;height:100%}
</style>
</head>

<body>

<div id="side">
<div id="header">
<img id="logo" src="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logo.png?raw=true">
</div>
<div id="list"></div>
</div>

<div id="player">
<video id="video" autoplay controls></video>
</div>

<script>
const list = document.getElementById('list');
const video = document.getElementById('video');
let hls = null;
let items = [];
let focus = 0;

/* ================= LOAD M3U ================= */
fetch('canais.m3u')
.then(r => r.text())
.then(txt => {
let name = '';
txt.split('\n').forEach(l => {
if(l.startsWith('#EXTINF')) name = l.split(',').pop();
else if(l.startsWith('http')) items.push({nome:name,url:l});
});
render();
if(items[0]) play(items[0].url);
});

/* ================= RENDER ================= */
function render(){
list.innerHTML='';
items.forEach((i,idx)=>{
const d=document.createElement('div');
d.className='item';
d.innerText=i.nome;
d.onclick=()=>play(i.url);
list.appendChild(d);
});
updateFocus();
}

/* ================= PLAY ================= */
function play(url){
if(hls){hls.destroy();hls=null;}
if(url.includes('.m3u8') && Hls.isSupported()){
hls=new Hls();
hls.loadSource(url);
hls.attachMedia(video);
}else{
video.src=url;
}
video.play().catch(()=>{});
}

/* ================= FOCUS ================= */
function updateFocus(){
const els=document.querySelectorAll('.item');
els.forEach((e,i)=>e.classList.toggle('focus',i===focus));
els[focus]?.scrollIntoView({block:'center'});
}

/* ================= KEYS ================= */
document.addEventListener('keydown',e=>{
if(e.key==='ArrowDown' && focus<items.length-1) focus++;
if(e.key==='ArrowUp' && focus>0) focus--;
if(e.key==='Enter') document.querySelectorAll('.item')[focus]?.click();
updateFocus();
});
</script>

</body>
</html>
