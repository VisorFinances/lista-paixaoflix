<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Paix√£oFlix TV</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>

<style>
*{
    box-sizing:border-box;
    -webkit-tap-highlight-color:transparent;
}

html,body{
    margin:0;
    padding:0;
    width:100%;
    height:100%;
    background:#000;
    color:#fff;
    font-family:'Poppins',sans-serif;
    overflow:hidden;
}

/* ================= MENU ================= */
#menu{
    width:220px;
    background:#132937;
    display:flex;
    flex-direction:column;
    height:100%;
    border-right:1px solid #0f2027;
}

.menu-item{
    background:#00004d;
    border-bottom:3px solid #000030;
}

.menu-item.active{
    background:#fff!important;
    color:#000!important;
}

/* ================= T√çTULOS ================= */
.channel span{
    display:block;
    max-width:100%;
    word-wrap:break-word;
    white-space:normal;
    line-height:1.2;
}

/* quebra a cada 20 caracteres */
.channel span{
    word-break:break-word;
}

/* ================= MOBILE ================= */
@media (max-width:768px){
    #menu{
        width:70px;
    }
    #menuHeader img{
        height:60px;
    }
}

/* bloqueio landscape mobile */
#rotateLock{
    position:fixed;
    inset:0;
    background:#000;
    color:#fff;
    display:none;
    align-items:center;
    justify-content:center;
    z-index:9999;
    text-align:center;
    font-size:18px;
}
</style>
</head>

<body>

<div id="rotateLock">
    <div>
        üîÑ<br>
        Use o dispositivo na posi√ß√£o <b>vertical</b>
    </div>
</div>

<div id="app">
    <!-- MENU (INALTERADO VISUALMENTE) -->
    <div id="menu">
        <div id="menuHeader">
            <img src="https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png">
            <div id="clock"></div>
        </div>

        <div id="searchBox">
            <input type="text" id="searchInput" placeholder="Pesquisar...">
        </div>

        <div id="menuItemsArea">
            <div class="menu-item active" data-type="recent"><i class="fas fa-history"></i> Assistindo agora</div>
            <div class="menu-item" data-type="channels"><i class="fas fa-tv"></i> TV ao vivo</div>
            <div class="menu-item" data-type="fav"><i class="fas fa-star"></i> Favoritos</div>
            <div class="menu-item" data-type="categories"><i class="fas fa-film"></i> Cinema</div>
            <div class="menu-item" data-type="series"><i class="fas fa-clapperboard"></i> S√©ries</div>
        </div>
    </div>

    <!-- CONTE√öDO -->
    <div id="content">
        <video id="video" controls playsinline></video>
        <div id="channelList"></div>
    </div>
</div>

<script>
/* ================= DETEC√á√ÉO DE DISPOSITIVO ================= */
const isMobile = window.matchMedia("(pointer: coarse)").matches;

/* ================= BLOQUEIO LANDSCAPE MOBILE ================= */
function checkOrientation(){
    if(isMobile && window.innerWidth > window.innerHeight){
        document.getElementById("rotateLock").style.display="flex";
    }else{
        document.getElementById("rotateLock").style.display="none";
    }
}
window.addEventListener("resize",checkOrientation);
checkOrientation();

/* ================= PLAYER ================= */
const video=document.getElementById("video");
let lastTime=0;

video.addEventListener("timeupdate",()=>{
    localStorage.setItem("pf_last_time",video.currentTime);
});

function playMedia(item){
    const url=item.url||item.link;
    const saved=localStorage.getItem("pf_last_time");

    if(saved && confirm("Deseja continuar assistindo?")){
        video.currentTime=parseFloat(saved);
    }else{
        video.currentTime=0;
    }

    video.src=url;
    video.play();
}

/* ================= FAVORITOS ================= */
let favorites=JSON.parse(localStorage.getItem("pf_favs")||"[]");

function toggleFav(item){
    const i=favorites.findIndex(f=>f.titulo===item.titulo);
    if(i>-1) favorites.splice(i,1);
    else favorites.push(item);
    localStorage.setItem("pf_favs",JSON.stringify(favorites));
}

/* ================= PESQUISA GLOBAL ================= */
document.getElementById("searchInput").addEventListener("input",e=>{
    const q=e.target.value.toLowerCase();
    filteredList=allData.filter(i=>
        (i.titulo||"").toLowerCase().includes(q)
    );
    renderList();
});

/* ================= LISTA ================= */
let allData=[];
let filteredList=[];
let selectedIndex=0;

function renderList(){
    const list=document.getElementById("channelList");
    list.innerHTML="";
    filteredList.forEach((item,i)=>{
        const div=document.createElement("div");
        div.className="channel"+(i===selectedIndex?" active":"");

        const span=document.createElement("span");
        span.textContent=item.titulo;

        /* PLAYER NA CAPA SOMENTE MOBILE */
        if(isMobile){
            div.onclick=()=>playMedia(item);
        }else{
            span.onclick=()=>playMedia(item);
        }

        div.appendChild(span);
        list.appendChild(div);
    });
}

/* ================= TECLADO / DIRECIONAL ================= */
document.addEventListener("keydown",e=>{
    if(e.key==="ArrowDown"){selectedIndex++;renderList();}
    if(e.key==="ArrowUp"){selectedIndex--;renderList();}
    if(e.key==="Enter") playMedia(filteredList[selectedIndex]);
});
</script>

</body>
</html>
