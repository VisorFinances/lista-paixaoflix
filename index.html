<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PaixaoFlix TV</title>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#000;
  color:#fff;
  overflow:hidden;
}

/* HEADER */
header{
  display:flex;
  align-items:center;
  gap:20px;
  padding:12px 20px;
  background:#111;
}

header img{
  height:48px;
}

nav button{
  background:#222;
  border:none;
  color:#fff;
  padding:8px 14px;
  border-radius:6px;
  margin:0 2px;
  cursor:pointer;
}

nav button.active{
  border-left:4px solid red;
  background:#333;
}

#search{
  margin-left:auto;
  padding:6px 10px;
  border-radius:8px;
  border:none;
  outline:none;
  width:180px;
}

/* LAYOUT */
#app{
  display:flex;
  height:calc(100vh - 72px);
}

#list{
  width:320px;
  overflow-y:auto;
  background:#111;
}

.item{
  padding:10px 12px;
  cursor:pointer;
}

.item.active{
  background:#222;
  border-left:4px solid red;
}

/* PLAYER */
#player{
  flex:1;
  position:relative;
  background:#000;
}

video, iframe{
  width:100%;
  height:100%;
  border:none;
  background:#000;
}

/* ASSISTINDO AGORA */
#now{
  position:absolute;
  top:10px;
  left:10px;
  background:rgba(0,0,0,.7);
  padding:6px 10px;
  border-radius:6px;
  font-size:14px;
}

/* OVERLAY NETFLIX */
#netflixOverlay{
  position:absolute;
  bottom:40px;
  left:40px;
  display:none;
  gap:15px;
  align-items:flex-start;
  background:rgba(0,0,0,.75);
  padding:18px;
  border-radius:10px;
  max-width:620px;
}

#netflixOverlay img{
  width:110px;
  height:160px;
  object-fit:cover;
  border-radius:6px;
}

#netflixOverlay h2{
  margin:0;
  font-size:20px;
}

#netflixOverlay p{
  margin-top:6px;
  font-size:14px;
  color:#ccc;
}

/* SCROLL */
#list::-webkit-scrollbar{
  width:6px;
}
#list::-webkit-scrollbar-thumb{
  background:#444;
  border-radius:10px;
}
</style>
</head>

<body>

<header>
  <img src="logo.png" alt="PaixaoFlix">
  <nav>
    <button id="btnTv">TV</button>
    <button id="btnFilmes">Filmes</button>
    <button id="btnSeries">SÃ©ries</button>
  </nav>
  <input id="search" placeholder="Buscar...">
</header>

<div id="app">
  <div id="list"></div>

  <div id="player">
    <div id="now"></div>

    <video id="video" controls autoplay></video>

    <div id="netflixOverlay">
      <img id="ovImg">
      <div>
        <h2 id="ovTitle"></h2>
        <p id="ovDesc"></p>
      </div>
    </div>
  </div>
</div>

<script>
let mode='tv';
let items=[];
let index=0;

const list=document.getElementById('list');
const video=document.getElementById('video');
const now=document.getElementById('now');
const search=document.getElementById('search');

const btnTv=document.getElementById('btnTv');
const btnFilmes=document.getElementById('btnFilmes');
const btnSeries=document.getElementById('btnSeries');

const netflixOverlay=document.getElementById('netflixOverlay');
const ovImg=document.getElementById('ovImg');
const ovTitle=document.getElementById('ovTitle');
const ovDesc=document.getElementById('ovDesc');

let overlayTimer=null;

/* -------------------- LOADERS -------------------- */
async function loadTv(){
  const txt=await fetch('data/canais.m3u').then(r=>r.text());
  items=[];
  txt.split('#EXTINF').slice(1).forEach(c=>{
    const name=c.split(',')[1]?.split('\n')[0];
    const url=c.split('\n').find(l=>l.startsWith('http'));
    if(name && url) items.push({title:name,url});
  });
}

async function loadFilmes(){
  items=await fetch('data/filmes.json').then(r=>r.json());
}

async function loadSeries(){
  items=await fetch('data/series.json').then(r=>r.json());
}

/* -------------------- RENDER -------------------- */
function render(){
  list.innerHTML='';
  items.forEach((i,n)=>{
    const d=document.createElement('div');
    d.className='item'+(n===index?' active':'');
    d.innerText=i.title||i.nome;
    list.appendChild(d);
  });
}

/* -------------------- PLAYER -------------------- */
function play(item){
  netflixOverlay.style.display='none';
  now.innerText='Assistindo agora: '+(item.title||item.nome);

  if(item.url){
    video.src=item.url;
    video.play();
  }
}

/* -------------------- OVERLAY -------------------- */
function showOverlay(item){
  if(mode==='tv') return;
  ovImg.src=item.poster||'';
  ovTitle.innerText=item.title||item.nome;
  ovDesc.innerText=item.desc||'';
  netflixOverlay.style.display='flex';

  clearTimeout(overlayTimer);
  overlayTimer=setTimeout(()=>{
    netflixOverlay.style.display='none';
  },3000);
}

/* -------------------- NAV -------------------- */
document.addEventListener('keydown',e=>{
  if(e.key==='ArrowDown'){
    index=Math.min(index+1,items.length-1);
    render();
    showOverlay(items[index]);
  }
  if(e.key==='ArrowUp'){
    index=Math.max(index-1,0);
    render();
    showOverlay(items[index]);
  }
  if(e.key==='Enter'){
    play(items[index]);
  }
});

/* -------------------- SEARCH -------------------- */
search.addEventListener('input',()=>{
  const q=search.value.toLowerCase();
  document.querySelectorAll('.item').forEach(i=>{
    i.style.display=i.innerText.toLowerCase().includes(q)?'block':'none';
  });
});

/* -------------------- BUTTONS -------------------- */
btnTv.onclick=async()=>{
  mode='tv';
  btnTv.classList.add('active');
  btnFilmes.classList.remove('active');
  btnSeries.classList.remove('active');
  await loadTv(); index=0; render();
};

btnFilmes.onclick=async()=>{
  mode='filmes';
  btnFilmes.classList.add('active');
  btnTv.classList.remove('active');
  btnSeries.classList.remove('active');
  await loadFilmes(); index=0; render();
};

btnSeries.onclick=async()=>{
  mode='series';
  btnSeries.classList.add('active');
  btnTv.classList.remove('active');
  btnFilmes.classList.remove('active');
  await loadSeries(); index=0; render();
};

/* START */
btnTv.click();
</script>

</body>
</html>
