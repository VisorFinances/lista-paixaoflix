<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PaixãoFlix</title>

<style>
/* ================= RESET ================= */
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:#0b0b0f;
  color:#ffd84d;
  overflow:hidden;
}
:root{
  --card:#1b1b25;
  --border:rgba(255,255,255,.08);
  --focus:#e50914;
}
img{width:100%;display:block}
.hidden{display:none}
</style>

<!-- ================= SIDEBAR (NÃO MEXER) ================= -->
<style>
#sidebar{
  position:fixed;
  left:0;top:0;bottom:0;
  width:150px;
  background:#111118;
  border-right:1px solid var(--border);
  padding:1rem .5rem
}
#logo{display:flex;justify-content:center;margin-bottom:2rem}
#logo img{width:140px}

.menu a{
  display:block;
  text-align:center;
  padding:.8rem;
  border-radius:10px;
  margin-bottom:.3rem;
  color:#ffd84d;
  cursor:pointer;
}
.menu a:focus{
  outline:none;
  background:var(--card);
  box-shadow:0 0 0 3px var(--focus)
}
</style>

<!-- ================= HOME ================= -->
<style>
#home{
  margin-left:150px;
  height:100vh;
  padding:1.2rem;
}
.section{margin-bottom:2.6rem}
.section h2{
  margin-bottom:1rem;
  font-size:1.5rem;
}
.row{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:1rem
}
.card{
  background:var(--card);
  border-radius:14px;
  overflow:hidden
}
.card:focus{
  outline:none;
  box-shadow:0 0 0 4px var(--focus)
}
.card img{height:260px;object-fit:cover}
.card span{display:block;padding:.6rem}
</style>

<!-- ================= CONTINUAR ================= -->
<style>
.continuar-row{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:1rem
}
.continuar{
  background:var(--card);
  border-radius:14px;
  overflow:hidden
}
.continuar:focus{
  outline:none;
  box-shadow:0 0 0 4px var(--focus)
}
.continuar img{height:150px;object-fit:cover}
.progress{height:4px;background:#333}
.progress span{height:100%;width:60%;background:var(--focus);display:block}
.continuar p{padding:.6rem}
</style>

<!-- ================= DETALHES ================= -->
<style>
#details{
  display:none;
  height:100vh;
  margin-left:150px;
  background-size:cover;
  background-position:center;
}
.details-overlay{
  background:rgba(0,0,0,.8);
  height:100%;
  padding:3rem;
  display:flex
}
.details-poster{width:260px;margin-right:2rem}
.details-info h1{
  font-size:calc(2rem + 2px);
  font-weight:500;
  font-style:italic;
}
.details-info p{
  margin-top:3px;
  color:#fff;
}
</style>
</head>

<body>

<!-- ================= MENU ================= -->
<nav id="sidebar">
  <div id="logo">
    <img src="https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png">
  </div>

  <div class="menu">
    <a tabindex="1" onclick="goHome()">Início</a>
    <a tabindex="2" onclick="openTV()">TV</a>
    <a tabindex="3" onclick="loadCategory('data/filmes.json')">Cinema</a>
    <a tabindex="4" onclick="loadCategory('data/series.json')">Séries</a>
    <a tabindex="5" onclick="loadCategory('data/favoritos.json')">Minha Lista</a>
    <a tabindex="6" onclick="openKids()">Kids</a>
  </div>
</nav>

<!-- ================= HOME ================= -->
<div id="home">

<section class="section">
<h2>Em Alta</h2>
<div class="row" id="emAlta"></div>
</section>

<section class="section">
<h2>Novos</h2>
<div class="row" id="novos"></div>
</section>

<section class="section">
<h2>Continuar Assistindo</h2>
<div class="continuar-row" id="continuar"></div>
</section>

<section class="section">
<h2>Recomendados</h2>
<div class="row" id="recomendados"></div>
</section>

</div>

<!-- ================= DETALHES ================= -->
<div id="details">
  <div class="details-overlay">
    <div class="details-poster">
      <img id="detailsPoster">
    </div>
    <div class="details-info">
      <h1 id="detailsTitle"></h1>
      <p id="detailsMeta"></p>
      <p id="detailsDesc"></p>
    </div>
  </div>
</div>

<script>
/* ================= NAVEGAÇÃO TV ================= */
let area='menu'
let menu=[...document.querySelectorAll('.menu a')]
let focusables=[]
let m=0,c=0
menu[m].focus()

document.addEventListener('keydown',e=>{
  if(area==='menu'){
    if(e.key==='ArrowDown') m=(m+1)%menu.length
    if(e.key==='ArrowUp') m=(m-1+menu.length)%menu.length
    if(e.key==='ArrowRight'){area='home';c=0;focusables[c]?.focus();return}
    if(e.key==='Enter') menu[m].click()
    menu[m].focus()
  }else{
    const cols=4
    if(e.key==='ArrowRight') c=Math.min(c+1,focusables.length-1)
    if(e.key==='ArrowLeft'){
      if(c%cols===0){area='menu';menu[m].focus();return}
      c--
    }
    if(e.key==='ArrowDown') c=Math.min(c+cols,focusables.length-1)
    if(e.key==='ArrowUp') c=Math.max(c-cols,0)
    if(e.key==='Enter') focusables[c]?.click()
    focusables[c]?.focus()
  }
})

/* ================= HOME / DETALHES ================= */
function openDetails(item){
  home.style.display='none'
  details.style.display='block'
  details.style.backgroundImage=`url(${item.poster})`
  detailsPoster.src=item.poster
  detailsTitle.textContent=item.titulo
  detailsMeta.textContent=`⭐ ${item.rating} • ${item.year}`
  detailsDesc.textContent=item.desc
}

function goHome(){
  details.style.display='none'
  home.style.display='block'
  area='menu'
  menu[m].focus()
}

/* ================= LOADERS ================= */
function renderCard(item, container){
  const div=document.createElement('div')
  div.className='card'
  div.tabIndex=0
  div.innerHTML=`<img src="${item.poster}"><span>${item.titulo}</span>`
  div.onclick=()=>openDetails(item)
  container.appendChild(div)
}

function loadCategory(path){
  fetch(path).then(r=>r.json()).then(data=>{
    emAlta.innerHTML=''
    data.slice(0,4).forEach(i=>renderCard(i,emAlta))
    refreshFocus()
  })
}

function openTV(){
  console.log('TV:', 'data/ativa_canais.m3u', 'data/ativa_kids_canais.m3u')
}

function openKids(){
  loadCategory('data/kids_filmes.json')
}

/* ================= INIT ================= */
function refreshFocus(){
  focusables=[...document.querySelectorAll('.card,.continuar')]
}
fetch('data/filmes.json').then(r=>r.json()).then(d=>{
  d.slice(0,4).forEach(i=>renderCard(i,emAlta))
  refreshFocus()
})
</script>

<!-- ================= CINEMA / SÉRIES ================= -->
<style>
#catalogo{
  display:none;
  margin-left:150px;
  height:100vh;
  padding:1.2rem;
}
.categoria{
  margin-bottom:2.8rem;
}
.categoria h2{
  margin-bottom:1rem;
  font-size:1.5rem;
}
.categoria .row{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:1rem;
}
.info{
  font-size:.85rem;
  opacity:.9;
}
</style>

<div id="catalogo"></div>

<script>
/* ================= CATEGORIAS FIXAS ================= */
const categoriasFixas=[
"Lançamento 2026","Lançamento 2025","Ação","Aventura","Musical",
"Comédia","Drama","Nacional","Romance","Religioso","Ficção",
"Anime","Animação","Família","Clássicos","Dorama","Suspense",
"Policial","Crime","Terror","Documentários","Faroeste","Adulto"
]

/* ================= ABRIR CINEMA / SÉRIES ================= */
function loadCatalogo(path){
  home.style.display='none'
  details.style.display='none'
  catalogo.style.display='block'
  catalogo.innerHTML=''
  area='home'

  fetch(path).then(r=>r.json()).then(data=>{
    categoriasFixas.forEach(cat=>{
      const itens=data
        .filter(i=>i.genero===cat)
        .sort((a,b)=>a.titulo.localeCompare(b.titulo,'pt-BR'))

      if(itens.length===0) return

      const sec=document.createElement('section')
      sec.className='categoria'
      sec.innerHTML=`<h2>${cat}</h2><div class="row"></div>`
      const row=sec.querySelector('.row')

      itens.forEach(item=>{
        const card=document.createElement('div')
        card.className='card'
        card.tabIndex=0
        card.innerHTML=`
          <img src="${item.poster}">
          <span>${item.titulo}</span>
          <span class="info">${item.year} • ⭐ ${item.rating}</span>
        `
        card.onclick=()=>openDetails(item)
        row.appendChild(card)
      })

      catalogo.appendChild(sec)
    })

    refreshFocus()
  })
}

/* ================= MENU CONECTADO ================= */
document.querySelectorAll('.menu a')[2].onclick=()=>{
  loadCatalogo('data/filmes.json')
}
document.querySelectorAll('.menu a')[3].onclick=()=>{
  loadCatalogo('data/series.json')
}

/* ================= VOLTAR HOME ================= */
function goHome(){
  catalogo.style.display='none'
  details.style.display='none'
  home.style.display='block'
  area='menu'
  menu[m].focus()
}
</script>
</body>
</html>
