<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PaixãoFlix PRO 2026</title>
    <style>
        :root {
            --amarelo: #ffcc00;
            --vermelho: #ff0000;
            --bg: #05070a;
            --sidebar-w: 160px;
            --gap: 12px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; outline: none; }
        body { background: var(--bg); color: white; display: flex; height: 100vh; overflow: hidden; }
        ::-webkit-scrollbar { display: none; }

        /* SIDEBAR */
        #sidebar {
            width: var(--sidebar-w); background: #000; border-right: 1px solid #1a1a1a;
            display: flex; flex-direction: column; padding: 25px 15px; z-index: 100;
        }
        .menu-item {
            padding: 14px; margin-bottom: 12px; border-radius: 10px; color: var(--amarelo);
            cursor: pointer; font-weight: 800; text-align: center; border: none; background: transparent; transition: 0.2s;
        }
        .menu-item:focus { background: var(--amarelo); color: #000; transform: scale(1.05); }

        /* ÁREA DE CONTEÚDO */
        main { flex: 1; overflow-y: auto; padding: 40px 50px; scrollbar-width: none; }
        .brand { font-size: 42px; font-weight: 900; text-transform: uppercase; margin-bottom: 30px; }
        .p-vermelho { color: var(--vermelho); }
        .i-amarelo { color: var(--amarelo); }

        /* ESTRUTURA DA CATEGORIA */
        .category-section { margin-bottom: 12px; position: relative; width: 100%; }
        .cat-title { color: var(--amarelo); font-size: 20px; font-weight: 800; margin-bottom: 10px; text-transform: uppercase; }
        
        /* CONTAINER DE VISUALIZAÇÃO (MASK) */
        .carousel-view { 
            width: 100%; 
            overflow: hidden; 
            position: relative;
            padding: 10px 0;
        }

        /* TRILHO QUE SE MOVE */
        .carousel-track { 
            display: flex; 
            gap: var(--gap); 
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            width: max-content;
        }

        /* CAPA - CÁLCULO PARA 4 POR LINHA NA TELA */
        .card {
            flex: 0 0 calc((100vw - var(--sidebar-w) - 100px - (3 * var(--gap))) / 4);
            aspect-ratio: 2/3;
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            border: 4px solid transparent;
            background: #111;
        }
        .card:focus { border-color: white; transform: scale(1.05); z-index: 10; }
        .card img { width: 100%; height: 100%; object-fit: cover; }

        .rank {
            position: absolute; left: -10px; bottom: -15px; font-size: 100px;
            font-weight: 900; color: rgba(0,0,0,0.8); -webkit-text-stroke: 2px var(--amarelo); z-index: 2;
        }

        .infinite-arrow {
            position: absolute; right: -30px; top: 55%; color: var(--amarelo);
            font-size: 30px; pointer-events: none; opacity: 0.6;
        }
    </style>
</head>
<body>

<nav id="sidebar">
    <img src="https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png" style="width:100%; margin-bottom:30px">
    <button class="menu-item" onclick="renderHome()">INÍCIO</button>
    <button class="menu-item" onclick="renderCatalogo('movie')">CINEMA</button>
    <button class="menu-item" onclick="renderCatalogo('serie')">SÉRIES</button>
</nav>

<main id="app-view">
    </main>

<script>
    let db = [];
    const CATEGORIAS = ["Lançamento 2026", "Ação", "Aventura", "Comédia", "Drama", "Terror", "Suspense", "Policial", "Religioso"];

    async function init() {
        const files = ['data/filmes.json', 'data/series.json'];
        const res = await Promise.all(files.map(f => fetch(f).then(r => r.json()).catch(() => [])));
        db = res.flat();
        renderHome();
    }

    function renderHome() {
        const view = document.getElementById('app-view');
        view.innerHTML = `
            <div class="brand"><span class="p-vermelho">PaixãoFlix</span> <span class="i-amarelo">indica hoje</span></div>
            <div class="category-section">
                <div class="carousel-view">
                    <div class="carousel-track" id="row-destaques"></div>
                </div>
            </div>
        `;
        const container = document.getElementById('row-destaques');
        db.slice(0, 12).forEach((item, i) => { // Exemplo com 12 itens
            container.innerHTML += createCard(item, i < 4 ? i + 1 : null);
        });
        applyNavigation(container);
    }

    function renderCatalogo(type) {
        const view = document.getElementById('app-view');
        view.innerHTML = `<div class="brand"><span class="p-vermelho">Paixão</span> <span class="i-amarelo">${type.toUpperCase()}</span></div>`;
        
        const filtered = db.filter(i => i.type === type);

        CATEGORIAS.forEach(cat => {
            const itens = filtered.filter(i => (cat.includes("Lançamento") ? i.year === "2026" : i.genero === cat));
            if (itens.length > 0) {
                const rowId = `row-${cat.replace(/\s/g, '')}`;
                view.innerHTML += `
                    <div class="category-section">
                        <div class="cat-title">${cat}</div>
                        <div class="carousel-view">
                            <div class="carousel-track" id="${rowId}">${itens.map(i => createCard(i)).join('')}</div>
                        </div>
                        <div class="infinite-arrow">➤</div>
                    </div>
                `;
                setTimeout(() => applyNavigation(document.getElementById(rowId)), 10);
            }
        });
    }

    function createCard(item, rank = null) {
        return `
            <div class="card" tabindex="0">
                ${rank ? `<span class="rank">${rank}</span>` : ''}
                <img src="${item.poster}">
            </div>
        `;
    }

    // LÓGICA DE NAVEGAÇÃO INFINITA REAL
    function applyNavigation(track) {
        const cards = track.querySelectorAll('.card');
        cards.forEach((card, index) => {
            card.addEventListener('keydown', (e) => {
                const cardWidth = card.offsetWidth + 12; // Largura + Gap
                
                if (e.key === 'ArrowRight') {
                    e.preventDefault();
                    if (index === cards.length - 1) {
                        // VOLTA PARA O PRIMEIRO (INFINITO)
                        track.style.transform = `translateX(0px)`;
                        cards[0].focus();
                    } else {
                        // MOVE O TRILHO SE O FOCO SAIR DA VISÃO (4ª POSIÇÃO)
                        if (index >= 3) {
                            track.style.transform = `translateX(-${cardWidth * (index - 2)}px)`;
                        }
                        cards[index + 1].focus();
                    }
                }

                if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    if (index === 0) {
                        // VAI PARA O ÚLTIMO (INFINITO)
                        const offset = cardWidth * (cards.length - 4);
                        track.style.transform = `translateX(-${offset > 0 ? offset : 0}px)`;
                        cards[cards.length - 1].focus();
                    } else {
                        if (index > 0) {
                            const currentOffset = cardWidth * (index - 1);
                            track.style.transform = `translateX(-${index <= 3 ? 0 : cardWidth * (index - 3)}px)`;
                        }
                        cards[index - 1].focus();
                    }
                }
            });
        });
    }

    window.onload = init;
</script>
</body>
</html>
