<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>PaixãoFlix TV</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; overflow: hidden; }
body { background: #000; color: #fff; font-family: 'Poppins', sans-serif; height: 100vh; width: 100vw; }

#layout-principal { display: flex; height: 100%; width: 100%; }

/* --- MENU LATERAL ESQUERDO --- */
#barra-menu { 
    width: 220px; 
    background: #001a1a; 
    border-right: 2px solid #003333;
    display: flex; flex-direction: column; z-index: 100;
}

#header-logo { padding: 20px 10px; text-align: center; }
/* LOGO: 120px Padrão */
#header-logo img { max-height: 120px; width: auto; max-width: 100%; object-fit: contain; }

#itens-menu { flex: 1; padding: 10px; overflow-y: auto; }
.item-clicavel { 
    padding: 12px; font-size: 13px; margin-bottom: 8px; border-radius: 8px; 
    background: #0080ff; border-bottom: 3px solid #004d99;
    display: flex; align-items: center; cursor: pointer; transition: 0.2s;
}
.item-clicavel.selecionado { background: #fff !important; color: #000 !important; font-weight: bold; }

/* --- AREA DO PLAYER --- */
#area-player { flex: 1; position: relative; background: #000; }
#meu-video { width: 100%; height: 100%; object-fit: contain; z-index: 1; }

/* --- PAINEL DE CONTEÚDO (LISTA + CAPA COLADA) --- */
#painel-conteudo { 
    position: absolute; left: 0; top: 0; height: 100%; 
    background: rgba(0,0,0,0.92); z-index: 50;
    display: none; /* Abre ao clicar no menu */
    align-items: center;
}

#lista-canais { 
    width: 260px; height: 100%; border-right: 1px solid #444; 
    overflow-y: auto; padding: 10px 0;
}
.canal-item { padding: 12px 20px; font-size: 14px; border-bottom: 1px solid #222; cursor: pointer; }
.canal-item.ativo { background: #fff; color: #000; font-weight: bold; }

/* CAPA TOTALMENTE COLADA À LISTA */
#container-capa { padding: 0 20px; display: none; }
#imagem-capa { 
    height: 380px; width: auto; border-radius: 10px; 
    border: 3px solid #fff; box-shadow: 0 0 30px #000;
}

/* --- RESPONSIVIDADE MÓVEL --- */
@media (max-width: 850px) {
    #barra-menu { width: 160px; }
    #header-logo img { max-height: 71px; } /* LOGO: 71px MÓVEL */
    #lista-canais { width: 190px; }
    .item-clicavel { font-size: 11px; padding: 10px; }
    #imagem-capa { height: 240px; }
}

#relogio { font-size: 11px; color: #888; margin-top: 10px; text-align: center; }
</style>
</head>
<body>

<div id="layout-principal">
    <div id="barra-menu">
        <div id="header-logo">
            <img src="https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png">
            <div id="relogio"></div>
        </div>
        <div id="itens-menu">
            <div class="item-clicavel selecionado" data-tipo="canais"><i class="fas fa-tv"></i> TV ao vivo</div>
            <div class="item-clicavel" data-tipo="favoritos"><i class="fas fa-star"></i> Favoritos</div>
            <div class="item-clicavel" data-tipo="cinema"><i class="fas fa-film"></i> Cinema</div>
            <div class="item-clicavel" data-tipo="series"><i class="fas fa-clapperboard"></i> Séries</div>
            <div class="item-clicavel" data-tipo="kids"><i class="fas fa-child"></i> Kids</div>
        </div>
    </div>

    <div id="area-player">
        <video id="meu-video" autoplay playsinline controls></video>

        <div id="painel-conteudo">
            <div id="lista-canais"></div>
            <div id="container-capa">
                <img id="imagem-capa" src="">
            </div>
        </div>
    </div>
</div>

<script>
const video = document.getElementById("meu-video");
const listaCanais = document.getElementById("lista-canais");
const painelConteudo = document.getElementById("painel-conteudo");
const containerCapa = document.getElementById("container-capa");
const imagemCapa = document.getElementById("imagem-capa");
const botoesMenu = document.querySelectorAll(".item-clicavel");

let dadosCanais = [], hls = null;

// ATUALIZAR RELÓGIO
function carregarRelogio() {
    const d = new Date();
    document.getElementById("relogio").innerText = d.toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
}
setInterval(carregarRelogio, 1000); carregarRelogio();

// COMANDO POR TOQUE (TOUCH) E CLIQUE
document.addEventListener('click', (e) => {
    const btnMenu = e.target.closest('.item-clicavel');
    const btnCanal = e.target.closest('.canal-item');

    if (btnMenu) {
        botoesMenu.forEach(b => b.classList.remove('selecionado'));
        btnMenu.classList.add('selecionado');
        abrirPainel();
    }

    if (btnCanal) {
        const index = Array.from(listaCanais.children).indexOf(btnCanal);
        selecionarItem(index);
        playVideo(dadosCanais[index].url);
    }
});

function abrirPainel() {
    painelConteudo.style.display = "flex";
    renderizarItens();
}

function renderizarItens() {
    listaCanais.innerHTML = "";
    dadosCanais.forEach((item, i) => {
        const div = document.createElement("div");
        div.className = "canal-item";
        div.innerHTML = item.titulo;
        listaCanais.appendChild(div);
    });
}

function selecionarItem(index) {
    Array.from(listaCanais.children).forEach((el, i) => {
        el.classList.toggle('ativo', i === index);
    });
    // Mostrar Capa Colada
    if (dadosCanais[index].poster) {
        imagemCapa.src = dadosCanais[index].poster;
        containerCapa.style.display = "block";
    } else {
        containerCapa.style.display = "none";
    }
}

function playVideo(url) {
    if (!url) return;
    painelConteudo.style.display = "none";
    if (hls) hls.destroy();
    if (url.includes(".m3u8")) {
        if (Hls.isSupported()) {
            hls = new Hls(); hls.loadSource(url); hls.attachMedia(video);
        } else { video.src = url; }
    } else { video.src = url; }
}

// BUSCAR DADOS M3U
window.onload = () => {
    fetch("https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/data/ativa_canais.m3u")
    .then(r => r.text()).then(t => {
        let temp = null;
        t.split("\n").forEach(l => {
            if(l.startsWith("#EXTINF")) temp = { titulo: l.split(",").pop().trim() };
            else if(l.startsWith("http") && temp) { 
                temp.url = l.trim(); 
                // Exemplo de poster para teste
                temp.poster = "https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png";
                dadosCanais.push(temp); 
                temp = null; 
            }
        });
    });
};
</script>
</body>
</html>
