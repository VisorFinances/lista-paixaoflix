<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>PaixãoFlix</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#0b0b0f;
  --bg2:#14141a;
  --amarelo:#ffcc00;
  --azul:#0a2cff;
  --txt:#fff;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{background:var(--bg);color:var(--txt);overflow:hidden}

/* ===== SIDEBAR ===== */
#sidebar{
  position:fixed;left:0;top:0;
  width:90px;height:100vh;
  background:#000;
  display:flex;
  flex-direction:column;
  align-items:center;
  z-index:10;
}
#logo{
  width:60px;
  margin:20px 0;
  cursor:pointer;
}
.menu-icon{
  width:28px;height:28px;
  margin:14px 0;
  opacity:.7;
  cursor:pointer;
}
.menu-icon:focus{outline:2px solid var(--amarelo);opacity:1}

/* ===== HEADER ===== */
#header{
  position:fixed;
  left:90px;top:0;
  width:calc(100% - 90px);
  height:60px;
  background:rgba(0,0,0,.7);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9;
}
#contador{font-weight:bold}
#hora{
  position:absolute;
  right:20px;
}

/* ===== MAIN ===== */
#main{
  position:absolute;
  top:60px;
  left:90px;
  width:calc(100% - 90px);
  height:calc(100vh - 60px);
  overflow-y:auto;
  padding:20px;
}

/* ===== BOTÕES ===== */
.btn{
  background:#222;
  color:#fff;
  padding:10px 20px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  box-shadow:0 4px 0 var(--amarelo);
}
.btn:active{transform:translateY(4px);box-shadow:none}

/* ===== CAPAS ===== */
.row{margin-bottom:30px}
.row h2{margin-bottom:10px}
.covers{
  display:flex;
  gap:12px;
  overflow:hidden;
}
.cover{
  min-width:180px;
  cursor:pointer;
}
.cover img{
  width:100%;
  border-radius:6px;
}
.cover-info{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  margin-top:4px;
}

/* ===== PLAYER ===== */
#playerOverlay{
  position:fixed;
  inset:0;
  background:#000;
  display:none;
  z-index:20;
}
#playerOverlay video{
  width:100%;
  height:100%;
}
#exitPlayer{
  position:absolute;
  top:20px;left:20px;
  background:rgba(255,255,255,.2);
  color:#fff;
  border:none;
  padding:10px;
}

/* ===== SEARCH ===== */
#searchBox{
  position:fixed;
  left:90px;top:60px;
  width:300px;
  padding:10px;
  display:none;
  z-index:15;
}
#searchResults{
  position:fixed;
  left:90px;top:100px;
  background:#000;
  width:400px;
  max-height:60vh;
  overflow:auto;
  display:none;
  z-index:15;
}
.search-item{padding:10px;border-bottom:1px solid #333;cursor:pointer}
.search-item:hover{background:#222}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <img id="logo" src="https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png" tabindex="0">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/search--v1.png" tabindex="0" onclick="openSearch()">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/movie.png" tabindex="0" onclick="loadPage('filmes')">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/tv-show.png" tabindex="0" onclick="loadPage('series')">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/tv.png" tabindex="0" onclick="loadPage('canais')">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/children.png" tabindex="0" onclick="loadPage('kids_filmes')">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/baby.png" tabindex="0" onclick="loadPage('kids_series')">
  <img class="menu-icon" src="https://img.icons8.com/ios-filled/50/like.png" tabindex="0" onclick="loadPage('favoritos')">
</div>

<!-- HEADER -->
<div id="header">
  <div id="contador">Estamos evoluindo 0</div>
  <div id="hora"></div>
</div>

<input id="searchBox" placeholder="Pesquisar...">
<div id="searchResults"></div>

<!-- MAIN -->
<div id="main"></div>

<!-- PLAYER -->
<div id="playerOverlay">
  <button id="exitPlayer" onclick="closePlayer()">Sair</button>
  <video id="player" controls autoplay></video>
</div>

<script>
const main = document.getElementById("main");
const player = document.getElementById("player");
const overlay = document.getElementById("playerOverlay");
let currentBack = "home";
let allData=[];

/* ===== CLOCK ===== */
function updateClock(){
  const d=new Date();
  document.getElementById("hora").innerText =
    d.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})+
    " "+d.toLocaleTimeString("pt-BR",{hour12:false});
}
setInterval(updateClock,1000);updateClock();

/* ===== LOAD JSON ===== */
async function loadJSON(url){
  const r=await fetch(url);return r.json();
}

/* ===== HOME ===== */
async function home(){
  main.innerHTML="<h1>PaixãoFlix indica hoje</h1>";
  const files=["data/filmes.json","data/series.json","data/kids_filmes.json","data/kids_series.json"];
  let items=[];
  for(const f of files){
    const j=await loadJSON(f);
    items.push(...j);
  }
  allData=items;
  document.getElementById("contador").innerText="Estamos evoluindo "+items.length;
  items.sort(()=>0.5-Math.random());
  const top=items.slice(0,4);
  const row=document.createElement("div");
  row.className="covers";
  top.forEach((i,idx)=>{
    const c=document.createElement("div");
    c.className="cover";
    c.innerHTML=`
      <img src="${i.capa}">
      <div class="cover-info">
        <span>${i.ano}</span>
        <span>${i.avaliacao}</span>
        <span>${i.categoria}</span>
      </div>`;
    c.onclick=()=>openDetails(i);
    row.appendChild(c);
  });
  main.appendChild(row);
}
home();

/* ===== DETAILS ===== */
function openDetails(item){
  currentBack=item.tipo;
  main.innerHTML=`
  <div style="background:url(${item.fundo||item.capa}) center/cover fixed;height:100%">
    <div style="display:flex;gap:20px;background:rgba(0,0,0,.7);padding:20px">
      <img src="${item.capa}" width="220">
      <div>
        <h1>${item.titulo}</h1>
        <p>${item.ano} • ${item.avaliacao}</p>
        <p>${item.descricao||""}</p>
        <button class="btn" onclick="play('${item.url}')">Assistir agora</button>
        <button class="btn" onclick="home()">Voltar</button>
      </div>
    </div>
  </div>`;
}

/* ===== PLAYER ===== */
function play(url){
  overlay.style.display="block";
  player.src=url;
  player.play();
}
function closePlayer(){
  player.pause();
  overlay.style.display="none";
}

/* ===== SEARCH ===== */
function openSearch(){
  document.getElementById("searchBox").style.display="block";
  document.getElementById("searchResults").style.display="block";
}
searchBox.oninput=()=>{
  const q=searchBox.value.toLowerCase();
  searchResults.innerHTML="";
  allData.filter(i=>i.titulo.toLowerCase().includes(q))
  .forEach(i=>{
    const d=document.createElement("div");
    d.className="search-item";
    d.innerText=i.titulo;
    d.onclick=()=>openDetails(i);
    searchResults.appendChild(d);
  });
};

/* ===== LOAD PAGE ===== */
async function loadPage(type){
  main.innerHTML="";
  let url="";
  if(type==="filmes")url="data/filmes.json";
  if(type==="series")url="data/series.json";
  if(type==="kids_filmes")url="data/kids_filmes.json";
  if(type==="kids_series")url="data/kids_series.json";
  if(type==="favoritos")url="data/favoritos.json";

  if(type==="canais"){
    main.innerHTML="<h1>Canais ao Vivo</h1>";
    const txt=await fetch("data/ativa_kids_canais.m3u").then(r=>r.text());
    txt.split("\n").forEach(l=>{
      if(l.startsWith("#EXTINF")){
        const name=l.split(",")[1];
        const d=document.createElement("div");
        d.innerText=name;
        main.appendChild(d);
      }
    });
    return;
  }

  const data=await loadJSON(url);
  const row=document.createElement("div");
  row.className="covers";
  data.forEach(i=>{
    const c=document.createElement("div");
    c.className="cover";
    c.innerHTML=`
      <img src="${i.capa}">
      <div class="cover-info">
        <span>${i.ano}</span>
        <span>${i.avaliacao}</span>
      </div>`;
    c.onclick=()=>openDetails(i);
    row.appendChild(c);
  });
  main.appendChild(row);
}

/* ===== LOGO ===== */
logo.onclick=()=>location.reload();
</script>

</body>
</html>
