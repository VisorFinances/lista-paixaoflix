<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>PaixãoFlix TV</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>

<style>
html, body {
    margin: 0;
    padding: 0;
    background: #111;
    color: #fff;
    font-family: Arial, sans-serif;
    height: 100%;
    overflow: hidden;
}

#app {
    display: flex;
    height: 100%;
}

/* MENU */
#menu {
    width: 220px;
    background: #1a1a1a;
    display: flex;
    flex-direction: column;
}

#menuHeader {
    padding: 16px;
    border-bottom: 1px solid #222;
}

#menuHeader img {
    height: 72px;
}

#clock {
    margin-top: 8px;
    font-size: 15px;
}

.menu-item {
    padding: 18px 20px;
    font-size: 18px;
}

.menu-item.active {
    background: #222;
    border-left: 5px solid #ff9800;
    font-weight: bold;
}

.menu-item.kids {
    color: #ff9800;
}

/* CONTENT */
#content {
    flex: 1;
    position: relative;
    background: black;
    overflow: hidden;
}

/* PLAYER */
video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: black;
}

/* CHANNEL LIST */
#channelList {
    position: absolute;
    top: 0;
    left: 0;
    width: 260px;
    height: 100%;
    background: rgba(20,20,20,0.96);
    display: none;
    overflow: hidden;
}

.channel {
    padding: 14px 16px;
    font-size: 18px;
    border-bottom: 1px solid #222;
}

.channel.active {
    background: #ff9800;
    color: #000;
    font-weight: bold;
}

/* CINEMA */
#cinemaSection {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #111;
    display: none;
    flex-direction: column;
    overflow: hidden;
}

#cinemaHeader {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
}

#cinemaHeader img {
    width: 60%;
    max-height: 360px;
    object-fit: cover;
    margin-bottom: 12px;
    border-radius: 8px;
}

#cinemaHeader h2 {
    margin: 0;
    font-size: 28px;
}

#cinemaHeader p {
    margin: 4px 0 0 0;
    font-size: 16px;
    color: #ccc;
    text-align: center;
}

#cinemaList {
    flex: 1;
    display: flex;
    overflow-x: auto;
    padding: 16px;
    scroll-behavior: smooth;
}

.cinema-card {
    min-width: 200px;
    margin-right: 14px;
    background: #1a1a1a;
    border-radius: 8px;
    overflow: hidden;
    cursor: pointer;
    flex-shrink: 0;
}

.cinema-card img {
    width: 100%;
    height: 280px;
    object-fit: cover;
}

.cinema-card .info {
    padding: 8px;
}

.cinema-card .info h3 {
    margin: 0;
    font-size: 18px;
}

.cinema-card .info p {
    margin: 4px 0 0 0;
    font-size: 14px;
    color: #ccc;
}
</style>
</head>

<body>

<div id="app">

    <div id="menu">
        <div id="menuHeader">
            <img src="https://raw.githubusercontent.com/VisorFinances/lista-paixaoflix/refs/heads/main/logoof512.png">
            <div id="clock"></div>
        </div>

        <div class="menu-item active" data-section="tv">TV ao vivo</div>
        <div class="menu-item" data-section="cinema">Cinema</div>
        <div class="menu-item" data-section="series">Séries</div>
        <div class="menu-item kids" data-section="canalkids">Canal Kids</div>
        <div class="menu-item kids" data-section="filmeskids">Filmes Kids</div>
        <div class="menu-item kids" data-section="serieskids">Séries Kids</div>
    </div>

    <div id="content">
        <!-- TV AO VIVO -->
        <video id="video" autoplay></video>
        <div id="channelList"></div>

        <!-- CINEMA -->
        <div id="cinemaSection">
            <div id="cinemaHeader">
                <img id="cinemaPoster" src="">
                <h2 id="cinemaTitle"></h2>
                <p id="cinemaYearGenre"></p>
                <p id="cinemaDescription"></p>
            </div>
            <div id="cinemaList"></div>
        </div>
    </div>

</div>

<script>
const video = document.getElementById("video");
const channelList = document.getElementById("channelList");
const cinemaSection = document.getElementById("cinemaSection");
const cinemaPoster = document.getElementById("cinemaPoster");
const cinemaTitle = document.getElementById("cinemaTitle");
const cinemaYearGenre = document.getElementById("cinemaYearGenre");
const cinemaDescription = document.getElementById("cinemaDescription");
const cinemaList = document.getElementById("cinemaList");

let channels = [];
let currentIndex = 0;
let selectedIndex = 0;
let listOpen = false;
let hls = null;

let cinemaMovies = [];
let cinemaSelected = 0;

/* CLOCK */
function updateClock() {
    const d = new Date();
    const dias = ["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];
    const meses = ["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"];
    clock.innerText =
        `${dias[d.getDay()]}, ${String(d.getDate()).padStart(2,"0")} ${meses[d.getMonth()]} ${d.getFullYear()} | ${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`;
}
setInterval(updateClock, 1000);
updateClock();

/* LOAD M3U */
fetch("playlists/canais.m3u")
.then(r => r.text())
.then(text => {
    const lines = text.split("\n");
    let temp = null;

    lines.forEach(l => {
        l = l.trim();
        if (l.startsWith("#EXTINF")) {
            temp = { name: l.split(",").pop(), url: "" };
        } else if (l.startsWith("http") && temp) {
            temp.url = l;
            channels.push(temp);
            temp = null;
        }
    });

    renderChannels();
    playChannel(0);
});

/* RENDER CHANNELS */
function renderChannels() {
    channelList.innerHTML = "";
    channels.forEach((c, i) => {
        const div = document.createElement("div");
        div.className = "channel" + (i === selectedIndex ? " active" : "");
        div.innerText = c.name;
        channelList.appendChild(div);
    });
}

/* PLAY CHANNEL */
function playChannel(i) {
    currentIndex = (i + channels.length) % channels.length;
    selectedIndex = currentIndex;

    if (hls) {
        hls.destroy();
        hls = null;
    }

    const src = channels[currentIndex].url;

    if (Hls.isSupported() && src.endsWith(".m3u8")) {
        hls = new Hls();
        hls.loadSource(src);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
            video.play().catch(()=>{});
        });
    } else {
        video.src = src;
        video.play().catch(()=>{});
    }

    renderChannels();
}

/* SHOW/HIDE CHANNEL LIST */
function showList(open) {
    listOpen = open;
    channelList.style.display = open ? "block" : "none";
}

/* LOAD CINEMA */
cinemaMovies = [
  {
    "titulo": "Capitão América Admirável Mundo Novo",
    "link": "https://archive.org/download/pf-acaocapitaoamericaadmiravelmundonovo/Capitão%20América%20Admirável%20Mundo%20Novo.mp4",
    "desc": "Depois de se encontrar com o recém-eleito presidente dos EUA, Thaddeus Ross, Sam vê-se no meio de um incidente internacional. Ele tem de descobrir a razão por detrás de uma conspiração global nefasta antes que o verdadeiro cérebro faça com que o mundo inteiro fique vermelho.",
    "lançamento": "13-02-2025 (BR)",
    "genero": "AÇÃO",
    "poster": "https://image.tmdb.org/t/p/w600_and_h900_face/yWOtVhuwJ6f5j9ELD2k3wKELEln.jpg"
  },
  {
    "titulo": "Irmãos de Sangue: Malcolm X e Muhammad Ali",
    "link": "https://archive.org/download/pf-acaoirmaodesangue/Irmãos%20de%20Sangue%20Malcolm%20X%20e%20Muhammad%20Ali.mp4",
    "desc": "A história da amizade e do rompimento de dois dos maiores ícones do século XX.",
    "lançamento": "09-09-2021 (BR)",
    "genero": "DOCUMENTÁRIOS",
    "poster": "https://image.tmdb.org/t/p/w600_and_h900_face/8niel2KjxfcOGmLWQc6p2fo5pUm.jpg"
  }
  /* Adicione todos os filmes do seu JSON aqui */
];

renderCinema();
showCinemaMovie(0);

/* RENDER CINEMA LIST */
function renderCinema() {
    cinemaList.innerHTML = "";
    cinemaMovies.forEach((f, i) => {
        const card = document.createElement("div");
        card.className = "cinema-card";
        card.innerHTML = `<img src="${f.poster}"><div class="info"><h3>${f.titulo}</h3><p>${f.lançamento} | ${f.genero}</p></div>`;
        card.addEventListener("click", ()=> showCinemaMovie(i));
        cinemaList.appendChild(card);
    });
}

/* SHOW SELECTED CINEMA MOVIE */
function showCinemaMovie(i) {
    cinemaSelected = i;
    const f = cinemaMovies[i];
    cinemaPoster.src = f.poster;
    cinemaTitle.innerText = f.titulo;
    cinemaYearGenre.innerText = `${f.lançamento} | ${f.genero}`;
    cinemaDescription.innerText = f.desc || "";
}

/* MENU NAVIGATION */
const menuItems = document.querySelectorAll(".menu-item");
let activeMenu = 0;

function updateMenu() {
    menuItems.forEach((m, i) => {
        m.classList.toggle("active", i === activeMenu);
    });
    // Mostrar seção correspondente
    if(menuItems[activeMenu].dataset.section === "tv") {
        video.style.display = "block";
        channelList.style.display = listOpen ? "block" : "none";
        cinemaSection.style.display = "none";
    } else if(menuItems[activeMenu].dataset.section === "cinema") {
        video.style.display = "none";
        channelList.style.display = "none";
        cinemaSection.style.display = "flex";
    } else {
        video.style.display = "none";
        channelList.style.display = "none";
        cinemaSection.style.display = "none";
    }
}

/* MENU CONTROLE REMOTO */
document.addEventListener("keydown", e => {
    switch(e.key){
        case "ArrowUp":
            activeMenu = (activeMenu - 1 + menuItems.length) % menuItems.length;
            updateMenu();
            break;
        case "ArrowDown":
            activeMenu = (activeMenu + 1) % menuItems.length;
            updateMenu();
            break;
        case "Enter":
            updateMenu();
            break;
        case "ChannelUp":
            playChannel(currentIndex + 1);
            break;
        case "ChannelDown":
            playChannel(currentIndex - 1);
            break;
    }
});

updateMenu();

</script>

</body>
</html>
