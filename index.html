<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>PaixãoFlix</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logoof512.png?raw=true">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>
<style>
/* GLOBAL */
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Poppins;background:#000;color:#fff;overflow:hidden;height:100vh;display:flex}
::-webkit-scrollbar{display:none}

/* APP STRUCTURE */
#app{display:flex;height:100%;width:100%}

/* SIDEBAR */
#side{width:420px;background:#111;display:flex;flex-direction:column;border-right:1px solid #222}
#header{display:flex;align-items:center;justify-content:space-between;padding:16px}
#header img{width:160px}
#timebox{text-align:right}
#clock{font-size:20px;color:#fff}
#date{font-size:12px;color:#fff;opacity:.9}

/* SEARCH */
#search{margin:10px 16px;padding:10px;font-size:16px;background:#000;color:#fff;border:2px solid #e50914;border-radius:6px;outline:none}

/* NOW PLAYING */
#now{margin:5px 16px;font-size:13px}
#now span{font-size:14px;color:#fff}

/* MENU */
#menu{margin:10px 16px;display:flex;gap:6px;flex-wrap:wrap}
.btn{flex:1;padding:6px;font-size:14px;background:#222;border-radius:6px;text-align:center;cursor:pointer;user-select:none}
.btn.active{background:#e50914}
.btn.kids{background:#0056b3}
.btn.focus{outline:2px solid #fff}

/* LIST */
#list{flex:1;overflow-y:auto}
.item{padding:12px;border-bottom:1px solid #222;display:flex;justify-content:space-between;font-size:16px;cursor:pointer}
.item.focus{background:#222;border-left:6px solid #e50914}
.fav-icon{opacity:0.3;font-size:18px;margin-left:5px}
.item.is-fav .fav-icon{opacity:1;color:#e50914}

/* PLAYER */
#player{flex:1;position:relative;background:#000}
video{width:100%;height:100%}

/* OVERLAY */
#zap{position:absolute;bottom:40px;left:40px;background:rgba(0,0,0,0.8);padding:10px 20px;font-size:20px;border-left:6px solid #e50914;display:none}

/* META CARD */
#overlay-meta{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;display:none;flex-direction:column;justify-content:center;padding:40px;color:#fff;overflow:hidden}
#overlay-meta h1{font-size:28px;margin-bottom:10px}
#overlay-meta p{font-size:16px;line-height:1.4;margin-bottom:10px;color:#ccc}
#overlay-meta .meta-extra{font-size:16px;color:#e50914;margin-bottom:10px}
.btn-meta{padding:10px 20px;font-size:16px;border:none;border-radius:6px;cursor:pointer;margin-right:10px;outline:none}
.btn-play{background:#e50914;color:#fff}
.btn-back{background:#333;color:#fff}
.btn-meta.focus{outline:2px solid #fff}

</style>
</head>
<body>
<div id="app">

  <!-- SIDEBAR -->
  <div id="side">
    <div id="header">
      <img src="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logoof512.png?raw=true">
      <div id="timebox">
        <div id="clock"></div>
        <div id="date"></div>
      </div>
    </div>

    <input id="search" placeholder="Pesquisar...">

    <div id="now">Assistindo agora: <span>—</span></div>

    <div id="menu">
      <div class="btn active" data-session="tv">TV</div>
      <div class="btn" data-session="filmes">Filmes</div>
      <div class="btn" data-session="series">Séries</div>
      <div class="btn kids" data-session="kids">Canal Kids</div>
      <div class="btn kids" data-session="kidsconteudo">Filmes/Séries Kids</div>
      <div class="btn" data-session="fav">Favoritos</div>
    </div>

    <div id="list"></div>
  </div>

  <!-- PLAYER -->
  <div id="player">
    <video id="video" autoplay></video>
    <div id="zap"></div>
    <div id="overlay-meta">
      <h1 id="meta-title"></h1>
      <div class="meta-extra" id="meta-rating-year">★ -- | ----</div>
      <p id="meta-desc"></p>
      <div style="display:flex;margin-top:10px">
        <button class="btn-meta btn-play" id="btn-start">Assistir agora</button>
        <button class="btn-meta btn-back" id="btn-close">Voltar</button>
      </div>
    </div>
  </div>

</div>

<script>
const video = document.getElementById('video')
const listEl = document.getElementById('list')
const searchEl = document.getElementById('search')
const nowEl = document.querySelector('#now span')
const zapEl = document.getElementById('zap')
const overlayMeta = document.getElementById('overlay-meta')
const metaTitle = document.getElementById('meta-title')
const metaDesc = document.getElementById('meta-desc')
const metaRatingYear = document.getElementById('meta-rating-year')
const btnStart = document.getElementById('btn-start')
const btnClose = document.getElementById('btn-close')
const menuButtons = document.querySelectorAll('#menu .btn')

let items=[],view=[],currentIdx=0,hls=null,favs=[],currentSession='tv'
let focusIndex=0,focusables=[]

// CLOCK
function updateClock(){
  const d=new Date()
  document.getElementById('clock').innerText=d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'})
  document.getElementById('date').innerText=d.toLocaleDateString('pt-BR')
}
setInterval(updateClock,1000)
updateClock()

// FETCH DATA
async function fetchJSON(path){try{return await (await fetch(path)).json()}catch(e){return []}}
async function fetchM3U(path){try{return await (await fetch(path)).text()}catch(e){return ''}}

// RENDER LIST
function renderList(){
  listEl.innerHTML=''
  view.forEach((i,n)=>{
    const div=document.createElement('div')
    const isFav=favs.some(f=>f.nome===i.nome)
    div.className='item '+(isFav?'is-fav':'')
    div.innerHTML=`<span>${i.nome||i.titulo}</span><span class="fav-icon">★</span>`
    div.onclick=()=>{showMeta(i)}
    div.querySelector('.fav-icon').onclick=(e)=>{e.stopPropagation();toggleFav(i)}
    listEl.appendChild(div)
  })
  updateFocusables()
  focusIndex=0
  updateFocus()
}

// FOCUS NAVIGATION
function updateFocusables(){
  focusables=[searchEl,...menuButtons,...document.querySelectorAll('#list .item'),btnStart,btnClose]
}
function updateFocus(){
  focusables.forEach((f,i)=>f.classList.toggle('focus',i===focusIndex))
  const el=focusables[focusIndex]
  if(el?.classList.contains('item')) el.scrollIntoView({block:'center'})
}

// FAVORITES
function toggleFav(item){
  const idx=favs.findIndex(f=>f.nome===item.nome)
  if(idx>-1) favs.splice(idx,1)
  else favs.push(item)
  renderList()
}

// PLAY VIDEO
function playItem(i){
  const it=view[i]

