<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <title>PaixãoFlix - Oficial</title>
    <style>
        :root { --primary: #e50914; }
        body { margin:0; background:#000; color:#fff; font-family: Arial, sans-serif; display:flex; height:100vh; overflow:hidden; }
        
        /* Menu Lateral Original */
        #side { width:340px; background:#111; display:flex; flex-direction:column; border-right:1px solid #222; }
        #search-box { padding:15px; }
        #search { width:90%; padding:10px; background:#000; color:#fff; border:1px solid #444; font-size: 16px; }
        
        #buttons { display:grid; grid-template-columns: 1fr 1fr; gap:5px; padding:10px; }
        #buttons button { padding:12px; background:#222; color:#fff; border:none; cursor:pointer; font-weight:bold; }
        #buttons button.active { background: var(--primary); }

        #list { flex:1; overflow-y:auto; }
        .item { padding:15px; border-bottom:1px solid #222; cursor:pointer; font-size: 16px; }
        
        /* Área do Player */
        #player-area { flex:1; position:relative; background:#000; }
        video { width:100%; height:100%; display: block; }

        /* Overlay de Sinopse Restaurado */
        #overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); display:none; flex-direction:column; justify-content:center; padding:60px; box-sizing:border-box; z-index: 100; }
        #overlay h1 { font-size: 42px; margin: 0; }
        .meta-info { color: var(--primary); font-weight:bold; margin: 15px 0; }
        #m-desc { max-width:700px; line-height:1.6; font-size: 18px; color: #ccc; }
        
        .action-btns { margin-top:30px; }
        #btn-start { padding:18px 35px; background:var(--primary); color:#fff; border:none; font-weight:bold; cursor:pointer; margin-right: 15px; }
        #btn-close { padding:18px 35px; background:#333; color:#fff; border:none; cursor:pointer; }

        /* Estilo de Foco (Controle Remoto) */
        .focusable.focus { outline: 3px solid #fff; background: rgba(255,255,255,0.1); }
    </style>
</head>
<body>

<div id="side">
    <div id="search-box">
        <input id="search" class="focusable" placeholder="Pesquisar..." type="text">
    </div>
    <div id="buttons">
        <button id="btnTV" class="focusable active">TV</button>
        <button id="btnFilmes" class="focusable">FILMES</button>
    </div>
    <div id="list"></div>
</div>

<div id="player-area">
    <video id="video" controls autoplay></video>
    
    <div id="overlay">
        <h1 id="m-title"></h1>
        <div class="meta-info">Lançamento: <span id="m-year"></span> | ★ <span id="m-rating"></span></div>
        <p id="m-desc"></p>
        <div class="action-btns">
            <button id="btn-start" class="focusable">ASSISTIR AGORA</button>
            <button id="btn-close" class="focusable">VOLTAR</button>
        </div>
    </div>
</div>

<script>
    const video = document.getElementById('video');
    const overlay = document.getElementById('overlay');
    const listDiv = document.getElementById('list');
    let focusIdx = 0;

    // Dados do filme solicitado
    const filmesData = [
        {
            nome: "Avatar: Fogo e Cinzas",
            id_archive: "avatar-fogo-e-cinzas",
            desc: "Após a devastadora guerra contra a RDA e a perda do seu filho mais velho, Jake Sully e Neytiri enfrentam uma nova ameaça em Pandora: o Povo das Cinzas, uma tribo Na'vi violenta e sedenta de poder liderada pelo implacável Varang. A família de Jake deve lutar pela sua sobrevivência e pelo futuro de Pandora num conflito que os leva ao limite emocional e físico.",
            rating: "8.5",
            year: "17-12-2025"
        }
    ];

    function getFocusables() {
        return Array.from(document.querySelectorAll('.focusable')).filter(el => el.offsetParent !== null);
    }

    function updateFocus() {
        const els = getFocusables();
        els.forEach((el, i) => {
            el.classList.toggle('focus', i === focusIdx);
            if (i === focusIdx && el.id === 'search') el.focus();
        });
        if (els[focusIdx]) els[focusIdx].scrollIntoView({ block: 'center' });
    }

    // Busca o arquivo direto no Archive.org via Metadata API
    async function playFromArchive(id) {
        overlay.style.display = 'none';
        try {
            const res = await fetch(`https://archive.org/metadata/${id}`);
            const data = await res.json();
            // Pega o primeiro arquivo que seja vídeo
            const videoFile = data.files.find(f => f.name.endsWith('.mp4') || f.name.endsWith('.mkv') || f.name.endsWith('.m4v'));
            if (videoFile) {
                video.src = `https://archive.org/download/${id}/${videoFile.name}`;
                video.play();
            } else {
                alert("Arquivo de vídeo não encontrado no Archive.");
            }
        } catch (e) {
            alert("Erro ao conectar com o Archive.org");
        }
    }

    function abrirSinopse(item) {
        document.getElementById('m-title').innerText = item.nome;
        document.getElementById('m-desc').innerText = item.desc;
        document.getElementById('m-year').innerText = item.year;
        document.getElementById('m-rating').innerText = item.rating;
        overlay.style.display = 'flex';
        
        document.getElementById('btn-start').onclick = () => playFromArchive(item.id_archive);
        document.getElementById('btn-close').onclick = () => { overlay.style.display = 'none'; focusIdx = 1; updateFocus(); };
        
        focusIdx = getFocusables().indexOf(document.getElementById('btn-start'));
        updateFocus();
    }

    function carregarLista() {
        listDiv.innerHTML = '';
        filmesData.forEach(item => {
            const div = document.createElement('div');
            div.className = 'item focusable';
            div.innerText = item.nome;
            div.onclick = () => abrirSinopse(item);
            listDiv.appendChild(div);
        });
        updateFocus();
    }

    // Navegação Teclado/Controle Remoto
    document.addEventListener('keydown', (e) => {
        const els = getFocusables();
        if (e.keyCode === 40) focusIdx = Math.min(focusIdx + 1, els.length - 1); // Baixo
        if (e.keyCode === 38) focusIdx = Math.max(focusIdx - 1, 0); // Cima
        if (e.keyCode === 13) els[focusIdx].click(); // OK / Enter
        updateFocus();
    });

    // Filtro de Pesquisa
    document.getElementById('search').addEventListener('input', (e) => {
        const val = e.target.value.toLowerCase();
        Array.from(listDiv.children).forEach(el => {
            el.style.display = el.innerText.toLowerCase().includes(val) ? 'block' : 'none';
        });
    });

    document.getElementById('btnFilmes').onclick = carregarLista;
    window.onload = carregarLista;
</script>

</body>
</html>
