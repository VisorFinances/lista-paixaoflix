<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>PaixãoFlix – Web TV</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logo512.png?raw=true">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>

<style>
:root { --primary:#e50914; --bg:#111; }
body{margin:0;background:#000;color:#fff;font-family:Poppins;display:flex;height:100vh;overflow:hidden}
*{scrollbar-width:none;-ms-overflow-style:none}
*::-webkit-scrollbar{display:none}

#side{width:340px;background:var(--bg);display:flex;flex-direction:column;border-right:1px solid #222}
#top{padding:20px 20px 10px}
#header-row{display:flex;justify-content:space-between;align-items:center}
#logo{max-width:150px}
#clock{font-size:22px;font-weight:700}
#date{font-size:12px;opacity:.8}

#search{width:100%;padding:12px;border-radius:8px;border:1px solid var(--primary);background:#000;color:#fff}
#search.focus{outline:3px solid #fff}

#now-playing-bar{padding:10px 20px;font-size:13px;color:#aaa;display:flex;gap:8px}
.play-icon-small{width:12px;height:12px;fill:var(--primary)}

#buttons{display:grid;grid-template-columns:1fr 1fr;gap:6px;padding:10px}
#buttons button{padding:10px;border-radius:6px;background:#222;color:#fff;font-weight:700;font-size:11px;border:0}
#buttons button.active{background:var(--primary)}
#buttons button.focus{outline:3px solid #fff}

#list{flex:1;overflow-y:auto}
.item{padding:14px;border-bottom:1px solid #222;display:flex;justify-content:space-between;cursor:pointer;border-left:5px solid transparent}
.item.focus{border-left-color:var(--primary);background:rgba(255,255,255,.05)}

#player{flex:1;position:relative}
video{width:100%;height:100%}

#overlay-zap{position:absolute;bottom:60px;left:40px;background:rgba(0,0,0,.8);padding:15px 30px;border-left:8px solid var(--primary);display:none}
#zap-title{font-size:28px;font-weight:700}

#overlay-meta{position:absolute;top:0;left:0;width:100%;height:100%;background-size:cover;display:none;flex-direction:column;justify-content:center;padding:60px}
#overlay-meta::before{content:'';position:absolute;inset:0;background:linear-gradient(90deg,rgba(0,0,0,.85) 30%,transparent 100%)}
#overlay-meta *{position:relative;z-index:2}

.btn-meta{padding:12px 25px;border-radius:6px;border:none;font-weight:bold}
.btn-meta.focus{outline:3px solid #fff}
.btn-play{background:var(--primary);color:#fff}
.btn-back{background:#333;color:#fff;margin-left:10px}
</style>
</head>

<body>

<div id="side">
  <div id="top">
    <div id="header-row">
      <img id="logo" src="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logo.png?raw=true">
      <div><div id="clock"></div><div id="date"></div></div>
    </div>
    <input id="search" placeholder="Pesquisar...">
  </div>

  <div id="now-playing-bar">
    <svg class="play-icon-small" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    <span>Assistindo agora: <b id="current-title">Nenhum conteúdo</b></span>
  </div>

  <div id="buttons">
    <button id="btnTV">TV</button>
    <button id="btnFilmes">FILMES</button>
    <button id="btnSeries">SÉRIES</button>
    <button id="btnKidsCanais">CANAIS KIDS</button>
    <button id="btnKidsConteudo">KIDS</button>
    <button id="btnFav">FAVORITOS</button>
  </div>

  <div id="list"></div>
</div>

<div id="player">
  <video id="video" autoplay></video>
  <div id="overlay-zap"><div id="zap-title"></div></div>
  <div id="overlay-meta">
    <h1 id="meta-title"></h1>
    <p id="meta-desc"></p>
    <div>
      <button id="btn-start" class="btn-meta btn-play">ASSISTIR</button>
      <button id="btn-close" class="btn-meta btn-back">VOLTAR</button>
    </div>
  </div>
</div>

<script>
const video=document.getElementById('video');
const list=document.getElementById('list');
const search=document.getElementById('search');
const currentTitle=document.getElementById('current-title');

let items=[],focusIndex=0,hls=null,zapTimer=null;

function updateClock(){
 const d=new Date();
 clock.innerText=d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
 date.innerText=d.toLocaleDateString('pt-BR');
}
setInterval(updateClock,1000);updateClock();

function play(url,title,zap=false){
 if(hls){hls.destroy();hls=null}
 currentTitle.innerText=title;
 if(url.includes('.m3u8')&&Hls.isSupported()){
   hls=new Hls();hls.loadSource(url);hls.attachMedia(video);
 }else video.src=url;
 video.play();

 const key='resume_'+title;
 const saved=localStorage.getItem(key);
 if(saved) video.currentTime=parseFloat(saved);

 if(zap){
  zap-title.innerText=title;
  overlay-zap.style.display='block';
  clearTimeout(zapTimer);
  zapTimer=setTimeout(()=>overlay-zap.style.display='none',2000);
 }
}

video.addEventListener('timeupdate',()=>{
 if(currentTitle.innerText)
 localStorage.setItem('resume_'+currentTitle.innerText,video.currentTime);
});

function render(data=items){
 list.innerHTML='';
 data.forEach((i,idx)=>{
  const d=document.createElement('div');
  d.className='item';
  d.innerText=i.nome;
  d.onclick=()=>play(i.url,i.nome,true);
  list.appendChild(d);
 });
 refreshFocus();
}

function refreshFocus(){
 window.focusables=[search,...document.querySelectorAll('button'),...document.querySelectorAll('.item')];
}

function updateFocus(){
 window.focusables.forEach((e,i)=>e.classList.toggle('focus',i===focusIndex));
 window.focusables[focusIndex]?.scrollIntoView({block:'center'});
}

search.addEventListener('focus',()=>search.classList.add('focus'));
search.addEventListener('blur',()=>search.classList.remove('focus'));
search.addEventListener('input',()=>{
 const q=search.value.toLowerCase();
 render(items.filter(i=>i.nome.toLowerCase().includes(q)));
});

document.addEventListener('keydown',e=>{
 if(document.activeElement===search) return;
 switch(e.key){
  case'ArrowDown':focusIndex++;break;
  case'ArrowUp':focusIndex--;break;
  case'Enter':window.focusables[focusIndex]?.click();break;
  case' ':video.paused?video.play():video.pause();break;
  case'f':document.fullscreenElement?document.exitFullscreen():video.requestFullscreen();break;
  case'PageUp':zap(1);break;
  case'PageDown':zap(-1);break;
 }
 focusIndex=(focusIndex+window.focusables.length)%window.focusables.length;
 updateFocus();
});

function zap(dir){
 if(!items.length)return;
 focusIndex+=dir;
 const i=items[(focusIndex+items.length)%items.length];
 play(i.url,i.nome,true);
}

items=[
 {nome:'Canal Exemplo 1',url:'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8'},
 {nome:'Canal Exemplo 2',url:'https://test-streams.mux.dev/test_001/stream.m3u8'}
];

render();
</script>
</body>
</html>
