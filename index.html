<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>PaixãoFlix</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
    font-family:Poppins, sans-serif;
    background:#000;
    color:#fff;
    overflow:hidden
}
:focus{outline:3px solid #e50914}

header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:10px 20px;
    background:#000
}
#logo{width:160px}
#datetime{
    display:flex;
    flex-direction:column;
    align-items:flex-end
}
#time{font-size:15px}
#date{font-size:13px;opacity:.9}

#container{
    display:flex;
    height:calc(100vh - 70px)
}

/* MENU */
nav{
    width:240px;
    background:#111;
    padding:10px;
    overflow:hidden
}
nav button{
    width:100%;
    margin:6px 0;
    padding:8px;
    font-size:14px;
    background:#222;
    color:#fff;
    border:none;
    cursor:pointer
}
nav button.kids{background:#6a1b9a}

/* PLAYER */
#player-area{
    flex:1;
    display:flex;
    flex-direction:column
}
video{
    width:100%;
    height:40vh;
    background:#000
}

/* SEARCH */
#search{
    margin:10px;
    padding:10px;
    font-size:16px;
    width:95%
}
#now{
    margin-left:15px;
    font-size:13px;
    color:#fff
}
#now span{
    font-size:14px;
    color:#fff
}

/* CONTENT */
#content{
    flex:1;
    overflow-y:auto;
    padding:10px
}
#content::-webkit-scrollbar{display:none}

.item{
    padding:10px;
    border-bottom:1px solid #222
}

.overlay{
    position:fixed;
    bottom:20px;
    left:260px;
    background:rgba(0,0,0,.7);
    padding:8px 15px;
    font-size:14px;
    display:none
}

/* CARD INFO */
#info{
    position:fixed;
    right:0;
    top:40%;
    width:320px;
    background:#111;
    padding:15px;
    display:none
}
#info button{
    width:100%;
    margin-top:10px;
    font-size:16px;
    padding:8px;
    border:none
}
#watch{background:#e50914;color:#fff}
#back{background:#555;color:#fff}
</style>
</head>

<body>

<header>
    <img id="logo" src="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logoof512.png?raw=true">
    <div id="datetime">
        <div id="time"></div>
        <div id="date"></div>
    </div>
</header>

<div id="container">

<nav>
    <button data-section="tv">TV</button>
    <button data-section="movies">Filmes</button>
    <button data-section="series">Séries</button>
    <button class="kids" data-section="kids-tv">Canal Kids</button>
    <button class="kids" data-section="kids">Filmes/Séries Kids</button>
    <button data-section="favorites">Favoritos</button>
</nav>

<div id="player-area">
    <video id="player" autoplay controls></video>

    <input id="search" placeholder="Pesquisar...">
    <div id="now">Assistindo agora: <span id="nowTitle">---</span></div>

    <div id="content"></div>
</div>

</div>

<div class="overlay" id="overlay"></div>

<div id="info">
    <h3 id="infoTitle"></h3>
    <p id="infoDesc"></p>
    <button id="watch">Assistir agora</button>
    <button id="back">Voltar</button>
</div>

<script>
const player=document.getElementById('player')
const content=document.getElementById('content')
const overlay=document.getElementById('overlay')
const nowTitle=document.getElementById('nowTitle')
let currentList=[]
let index=0

/* CLOCK */
setInterval(()=>{
    const d=new Date()
    time.innerText=d.toLocaleTimeString()
    date.innerText=d.toLocaleDateString()
},1000)

/* LOAD */
function load(section){
    fetch(section+'.json').then(r=>r.json()).then(data=>{
        currentList=data
        content.innerHTML=''
        data.forEach((i,n)=>{
            let div=document.createElement('div')
            div.className='item'
            div.tabIndex=0
            div.innerText=i.name
            div.onfocus=()=>showOverlay(i.name)
            div.onclick=()=>play(n)
            content.appendChild(div)
        })
        index=0
        play(0)
    })
}

function play(i){
    index=i
    player.src=currentList[i].url
    nowTitle.innerText=currentList[i].name
}

/* OVERLAY */
function showOverlay(text){
    overlay.innerText=text
    overlay.style.display='block'
    clearTimeout(window.ov)
    window.ov=setTimeout(()=>overlay.style.display='none',2000)
}

/* SEARCH */
search.oninput=()=>{
    const v=search.value.toLowerCase()
    [...content.children].forEach(el=>{
        el.style.display=el.innerText.toLowerCase().includes(v)?'block':'none'
    })
}

/* REMOTE */
document.addEventListener('keydown',e=>{
    if(e.key==='ArrowDown'){index++;if(index>=currentList.length)index=0;play(index)}
    if(e.key==='ArrowUp'){index--;if(index<0)index=currentList.length-1;play(index)}
    if(e.key==='ChannelUp'){index++;play(index)}
    if(e.key==='ChannelDown'){index--;play(index)}
    if(e.key==='Enter'){play(index)}
})

/* MENU */
document.querySelectorAll('nav button').forEach(b=>{
    b.onclick=()=>load(b.dataset.section)
})

/* START */
load('tv')
</script>

</body>
</html>
