<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<title>PaixÃ£oFlix â€“ Web TV</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logo512.png?raw=true">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8"></script>

<style>
:root { --primary:#e50914; --bg:#111; }
body{margin:0;background:#000;color:#fff;font-family:Poppins;display:flex;height:100vh;overflow:hidden}
*{scrollbar-width:none}
*::-webkit-scrollbar{display:none}

#side{width:340px;background:var(--bg);display:flex;flex-direction:column;border-right:1px solid #222}
#top{padding:20px 20px 10px}
#header-row{display:flex;justify-content:space-between;align-items:center}
#logo{max-width:150px}
#clock{font-size:22px;font-weight:700}
#date{font-size:12px;opacity:.8}

#search{
  width:100%;
  padding:16px;
  font-size:16px;
  border-radius:8px;
  border:1px solid var(--primary);
  background:#000;
  color:#fff;
}
#search.focus{outline:3px solid #fff}

#now-playing-bar{padding:10px 20px;font-size:13px;color:#aaa;display:flex;gap:8px}
.play-icon-small{width:12px;height:12px;fill:var(--primary)}

#buttons{display:grid;grid-template-columns:1fr 1fr;gap:6px;padding:10px}
#buttons button{
  padding:10px;
  border-radius:6px;
  background:#222;
  color:#fff;
  font-weight:700;
  font-size:11px;
  border:0;
}
#buttons button.active{background:var(--primary)}
#buttons button.focus{outline:3px solid #fff}

#list{flex:1;overflow-y:auto}
.item{
  padding:14px;
  border-bottom:1px solid #222;
  cursor:pointer;
  border-left:5px solid transparent;
}
.item.focus{
  border-left-color:var(--primary);
  background:rgba(255,255,255,.05);
}

#player{flex:1;position:relative}
video{width:100%;height:100%;background:#000}

#overlay-zap{
  position:absolute;
  bottom:60px;
  left:40px;
  background:rgba(0,0,0,.8);
  padding:15px 30px;
  border-left:8px solid var(--primary);
  display:none;
}
#zap-title{font-size:28px;font-weight:700}
</style>
</head>

<body>

<div id="side">
  <div id="top">
    <div id="header-row">
      <img id="logo" src="https://github.com/VisorFinances/lista-paixaoflix/blob/main/logo.png?raw=true">
      <div>
        <div id="clock"></div>
        <div id="date"></div>
      </div>
    </div>
    <input id="search" placeholder="Pesquisar..." tabindex="0">
  </div>

  <div id="now-playing-bar">
    <svg class="play-icon-small" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
    <span>Assistindo agora: <b id="current-title">Nenhum conteÃºdo</b></span>
  </div>

  <div id="buttons">
    <button id="btnTV">TV</button>
    <button id="btnFilmes">FILMES</button>
    <button id="btnSeries">SÃ‰RIES</button>
    <button id="btnKidsCanais" style="background:#0056b3">CANAIS KIDS</button>
    <button id="btnKidsConteudo" style="background:#0056b3">FILMES/SÃ‰RIES KIDS</button>
    <button id="btnFav">FAVORITOS</button>
  </div>

  <div id="list"></div>
</div>

<div id="player">
  <video id="video" autoplay playsinline></video>
  <div id="overlay-zap"><div id="zap-title"></div></div>
</div>

<script>
const video=document.getElementById('video');
const list=document.getElementById('list');
const search=document.getElementById('search');
const currentTitle=document.getElementById('current-title');
const clockEl=document.getElementById('clock');
const dateEl=document.getElementById('date');

let items=[],focusables=[],focusIndex=0,mode='tv',hls=null,zapTimer=null;

/* â° DATA E HORA REAL */
function updateClock(){
  const d=new Date();
  clockEl.innerText=d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});
  dateEl.innerText=d.toLocaleDateString('pt-BR');
}
setInterval(updateClock,1000);updateClock();

/* â–¶ï¸ PLAYER */
function playItem(item,zap=false){
  currentTitle.innerText=item.nome;
  if(hls){hls.destroy();hls=null}

  if(item.url.includes('.m3u8') && Hls.isSupported()){
    hls=new Hls({enableWorker:false});
    hls.loadSource(item.url);
    hls.attachMedia(video);
  }else{
    video.src=item.url;
  }
  video.play().catch(()=>{});

  if(zap){
    document.getElementById('zap-title').innerText=item.nome;
    document.getElementById('overlay-zap').style.display='block';
    clearTimeout(zapTimer);
    zapTimer=setTimeout(()=>overlay-zap.style.display='none',2000);
  }
}

/* ðŸ“‹ RENDER */
function render(){
  list.innerHTML='';
  items.forEach(i=>{
    const d=document.createElement('div');
    d.className='item';
    d.tabIndex=0;
    d.innerText=i.nome;
    d.onclick=()=>playItem(i,true);
    list.appendChild(d);
  });
  rebuildFocus();
}

/* ðŸŽ¯ FOCO */
function rebuildFocus(){
  focusables=[
    search,
    ...document.querySelectorAll('#buttons button'),
    ...document.querySelectorAll('.item')
  ];
  if(focusIndex>=focusables.length) focusIndex=0;
  updateFocus();
}

function updateFocus(){
  focusables.forEach((e,i)=>e.classList.toggle('focus',i===focusIndex));
  focusables[focusIndex]?.focus();
}

/* ðŸŽ® TECLAS (LG WEBOS / SAMSUNG / ANDROID) */
document.addEventListener('keydown',e=>{
  const k=e.keyCode;

  if(document.activeElement===search) return;

  if(k===38) focusIndex--;        // UP
  if(k===40) focusIndex++;        // DOWN
  if(k===37) focusIndex--;        // LEFT
  if(k===39) focusIndex++;        // RIGHT

  if(k===13){                     // OK
    focusables[focusIndex]?.click();
  }

  if(k===427) zap(1);             // CH+
  if(k===428) zap(-1);            // CH-

  focusIndex=(focusIndex+focusables.length)%focusables.length;
  updateFocus();
});

/* ðŸ”€ ZAP */
function zap(dir){
  if(!items.length) return;
  focusIndex+=dir;
  const item=items[(focusIndex+items.length)%items.length];
  playItem(item,true);
}

/* ðŸ” PESQUISA */
search.addEventListener('input',()=>{
  const q=search.value.toLowerCase();
  const filtered=items.filter(i=>i.nome.toLowerCase().includes(q));
  list.innerHTML='';
  filtered.forEach(i=>{
    const d=document.createElement('div');
    d.className='item';
    d.innerText=i.nome;
    d.onclick=()=>playItem(i,true);
    list.appendChild(d);
  });
  rebuildFocus();
});

/* ðŸ“º TV (AUTOPLAY PRIMEIRO CANAL) */
function loadTV(){
  mode='tv';
  fetch('canais.m3u')
    .then(r=>r.text())
    .then(txt=>{
      items=[];
      let name='';
      txt.split('\n').forEach(l=>{
        if(l.startsWith('#EXTINF')) name=l.split(',').pop();
        if(l.startsWith('http')) items.push({nome:name.trim(),url:l.trim()});
      });
      render();
      if(items.length) playItem(items[0],true);
    });
}

loadTV();
</script>

</body>
</html>
